---
import Key from "@/components/Key.astro"
import { basics } from "@cv"

const { profiles } = basics
const profilesInfo = profiles.map(({ network, url }) => {
  return {
    section: "Socials",
    id: network,
    title: `Open ${network}`,
    icon: network.toLowerCase(),
    url
  }
})
---

<footer
  id="footer"
  class="fixed bottom-0 py-1 w-full bg-white border-t border-gray-300 text-gray-600 text-center z-10 print:hidden"
>
  Press <Key>⌘ / Ctrl</Key> + <Key>K</Key> to open the command palette.
</footer>

<ninja-keys
  hideBreadcrumbs
  class="print:hidden"
  data-profiles-info={JSON.stringify(profilesInfo)}></ninja-keys>

<style>
  @keyframes slideUp {
    from {
      transform: translateY(100%);
    }
    to {
      transform: translateY(0);
    }
  }

  #footer {
    view-timeline-name: --reveal-footer;
    view-timeline-axis: block;
    animation: slideUp 0.25s ease-out;
    animation-timeline: --reveal-footer;
    animation-range: entry 100% cover 20%;
  }
</style>

<script>
  import "ninja-keys"
  const ninja = document.querySelector("ninja-keys")
  const activationKey = navigator.userAgent.includes("Macintosh") ? "⌘" : "Ctrl"

  if (ninja != null) {
    const dataInfo = ninja!.getAttribute("data-profiles-info") ?? "[]"
    const parsedInfo = JSON.parse(dataInfo)
    const profilesInfo = parsedInfo.map((info: any) => {
      return {
        ...info,
        icon: `<img width="24px" style="margin-right: 8px;" src="https://simpleicons.org/icons/${info.icon}.svg" alt="${info.title}" />`,
        hotkey: `${activationKey} + ${info.id[0].toUpperCase()}`,
        handler: () => {
          window.open(info.url, "_blank")
        }
      }
    })

    ninja.data = [
      {
        section: "Actions",
        id: "print",
        title: "Print CV",
        icon: `<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;">
        <path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2" />
        <path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4" />
        <path d="M7 13m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z" />
      </svg>
      `,
        hotkey: `${activationKey} + P`,
        handler: () => {
          window.print()
        }
      },
      ...profilesInfo
    ]
  }
</script>
