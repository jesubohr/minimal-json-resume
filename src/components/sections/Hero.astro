---
import Section from "@/components/Section.astro"
import { basics } from "@cv"
const { name, location, label, email, phone, profiles, image } = basics
const { city, region, countryCode } = location
---

<Section>
  <div class="flex items-center flex-wrap gap-4 w-full">
    <div class="grow flex flex-col gap-1">
      <h1 class="text-3xl font-bold font-sans">{name}</h1>
      <p class="max-w-md text-gray-600 leading-snug text-balance font-medium">{label}</p>
      <span class="flex items-center gap-2 text-sm">
        <img src=`https://flagsapi.com/${countryCode}/flat/16.png` />
        <a
          href=`https://www.google.com/maps/place/${city}`
          title="Open in Google Maps"
          target="_blank"
          rel="noopener noreferrer"
          class="text-gray-500 hover:text-gray-800 hover:underline transition-colors"
          >{city}, {region}</a
        >
      </span>
      <footer class="flex items-center gap-2">
        {
          email && (
            <button
              data-copy={email}
              title="Copy Email"
              class="p-1 border border-gray-300 rounded-md text-gray-500 hover:bg-gray-200 hover:text-gray-900 transition-colors"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5">
                <use xlink:href="/hero-icons.svg#email" />
              </svg>
            </button>
          )
        }
        {
          phone && (
            <button
              data-copy={phone}
              title="Copy Phone"
              class="p-1 border border-gray-300 rounded-md text-gray-500 hover:bg-gray-200 hover:text-gray-900 transition-colors"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5">
                <use xlink:href="/hero-icons.svg#phone" />
              </svg>
            </button>
          )
        }
        {
          profiles.map(({ network, url }) => (
            <a
              href={url}
              title={network}
              target="_blank"
              rel="noopener noreferrer"
              class="p-1 border border-gray-300 rounded-md text-gray-500 hover:bg-gray-200 hover:text-gray-900 transition-colors"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5">
                <use xlink:href={`/hero-icons.svg#${network.toLowerCase()}`} />
              </svg>
            </a>
          ))
        }
      </footer>
    </div>
    <figure class="size-32">
      <img src={image} alt={name} class="aspect-square w-full rounded-md" />
    </figure>
  </div>
</Section>

<script>
  const copyButtons = document.querySelectorAll("[data-copy]")

  copyButtons.forEach((button: HTMLButtonElement) => {
    button.addEventListener("click", () => {
      copyToClipboard(button.dataset.copy)
    })
  })

  async function copyToClipboard(text: string) {
    await window.navigator.clipboard.writeText(text)
    alert("Copied to clipboard")
  }
</script>
